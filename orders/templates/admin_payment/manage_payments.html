{% extends 'base.html' %}
{% block content %}
<h2>Manage Payments</h2>
<table border="1">
    <tr>
        <th>Order ID</th>
        <th>User</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Payment Method</th>
        <th>Actions</th>
    </tr>
    {% for payment in payments %}
    <tr>
        <td>{{ payment.order.id }}</td>
        <td>{{ payment.user.username }}</td>
        <td>${{ payment.amount }}</td>
        <td>{{ payment.payment_status }}</td>
        <td>{{ payment.payment_method }}</td>
        <td>
            <a href="{% url 'payment_details' payment.id %}">View</a> |
            {% if payment.payment_status == "Successful" and not payment.refund_status %}
            <a href="{% url 'issue_refund' payment.id %}" style="color: red;">Issue Refund</a>
            {% else %}
            <span>Refunded</span>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
